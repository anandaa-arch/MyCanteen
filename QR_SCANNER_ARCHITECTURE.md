# QR Scanner Architecture & Diagrams

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MyCanteen Application                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   User Flow      â”‚         â”‚   Admin Flow     â”‚              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚ /qr              â”‚         â”‚ /admin/          â”‚              â”‚
â”‚  â”‚ Generate QR      â”‚         â”‚ qr-scanner       â”‚              â”‚
â”‚  â”‚ Code             â”‚         â”‚ Scan QR          â”‚              â”‚
â”‚  â”‚                  â”‚         â”‚ Record           â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                           â”‚                         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                           â–¼                                     â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                  â”‚  API Route       â”‚                          â”‚
â”‚                  â”‚  /api/           â”‚                          â”‚
â”‚                  â”‚  attendance      â”‚                          â”‚
â”‚                  â”‚  (POST/GET)      â”‚                          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                           â–¼                                    â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                  â”‚  Supabase        â”‚                         â”‚
â”‚                  â”‚  PostgreSQL      â”‚                         â”‚
â”‚                  â”‚  poll_responses  â”‚                         â”‚
â”‚                  â”‚  table           â”‚                         â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚           â–¼                               â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  /attendance     â”‚          â”‚  Admin Stats     â”‚           â”‚
â”‚  â”‚  View History    â”‚          â”‚  Updated         â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Journey Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER JOURNEY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  LOGIN
â”‚    â†“
â”‚  DASHBOARD (/user/dashboard)
â”‚    â”œâ”€ [Bills]        [Menu]        [Meal History]
â”‚    â”œâ”€ [Attendance]   [Poll]        [Other Cards]
â”‚    â””â”€ Sees "Attendance" card (NEW)
â”‚       â†“ click
â”‚  ATTENDANCE PAGE (/attendance)
â”‚    â”œâ”€ View stats: Present (35), Absent (2), Rate (94%)
â”‚    â”œâ”€ See detailed table
â”‚    â”‚  Date    â”‚ Poll     â”‚ Status â”‚ Time
â”‚    â”‚ 10/22/25 â”‚ Lunch    â”‚ âœ“      â”‚ 10:30
â”‚    â”‚ 10/21/25 â”‚ Lunch    â”‚ âœ“      â”‚ 10:25
â”‚    â”‚ 10/20/25 â”‚ Dinner   â”‚ âœ—      â”‚ â€”
â”‚    â””â”€ Info box: "Attendance Information"
â”‚       â†“ OR Navigate to
â”‚  QR CODE PAGE (/qr)
â”‚    â”œâ”€ See QR code with logo
â”‚    â”œâ”€ User info displayed (Name, Email, Dept, Date)
â”‚    â”œâ”€ [ğŸ”„ Refresh QR Code] button
â”‚    â””â”€ Share QR with admin to scan
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Admin Journey Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ADMIN JOURNEY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  LOGIN
â”‚    â†“
â”‚  ADMIN DASHBOARD (/admin/dashboard)
â”‚    â”œâ”€ Nav Menu: [Dashboard] [Polls] [Billing]
â”‚    â”œâ”€ Nav Menu: [Menu] [QR Scanner] [Inventory]
â”‚    â”‚                       â†‘ NEW BUTTON
â”‚    â””â”€ Click [QR Scanner]
â”‚       â†“
â”‚  QR SCANNER PAGE (/admin/qr-scanner)
â”‚    â”œâ”€ STATS SECTION
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    â”‚  â”‚ Present: 45â”‚ Pending: 12â”‚ Total: 57     â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    â”‚  
â”‚    â”œâ”€ CONTROL SECTION
â”‚    â”‚  [ğŸ“± Open QR Scanner] â† Click to start
â”‚    â”‚
â”‚    â”œâ”€ CAMERA MODAL OPENS (NEW)
â”‚    â”‚  â”œâ”€ Camera selector dropdown (if multiple cameras)
â”‚    â”‚  â”œâ”€ Video stream shows
â”‚    â”‚  â”œâ”€ Visual scanning feedback
â”‚    â”‚  â”œâ”€ Manual paste option: [Paste QR data]
â”‚    â”‚  â””â”€ [Close] button
â”‚    â”‚       â†“ admin shows student QR
â”‚    â”‚       â†“ QR detected
â”‚    â”‚       â†“ API call to /api/attendance
â”‚    â”‚
â”‚    â”œâ”€ RESULT NOTIFICATION (AUTO-CLOSES AFTER 2s)
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    â”‚  â”‚ âœ… John Doe - john@email.com            â”‚
â”‚    â”‚  â”‚ Time: 10:30:45 AM                       â”‚
â”‚    â”‚  â”‚ Status: Confirmed Attended              â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    â”‚
â”‚    â”œâ”€ STATS AUTO-UPDATE
â”‚    â”‚  Present: 46 â¬†ï¸  (was 45)
â”‚    â”‚
â”‚    â””â”€ RECENT SCANS TABLE AUTO-UPDATE
â”‚       â”œâ”€ New entry appears at top
â”‚       â”œâ”€ Shows: Name, Email, Dept, Status, Time
â”‚       â””â”€ Green badge: âœ“ Present
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## QR Code Content Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        QR CODE (Visual)                â”‚
â”‚                                        â”‚
â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                 â”‚
â”‚    â–ˆâ–ˆ        MYCANTEEN  â–ˆâ–ˆ             â”‚
â”‚    â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ            â”‚
â”‚    â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ            â”‚
â”‚    â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ            â”‚
â”‚    â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ            â”‚
â”‚    â–ˆâ–ˆ        LOGO        â–ˆâ–ˆ            â”‚
â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                 â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ Encodes
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     QR CODE PAYLOAD (JSON)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                      â”‚
â”‚   "userId": "550e8400...",            â”‚
â”‚   "name": "John Doe",                 â”‚
â”‚   "email": "john@example.com",        â”‚
â”‚   "dept": "Computer Science",         â”‚
â”‚   "timestamp": "2025-10-22T10:30:00Z",â”‚
â”‚   "date": "2025-10-22",               â”‚
â”‚   "type": "attendance"                â”‚
â”‚ }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Database Record Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          poll_responses TABLE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BEFORE SCAN                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               â”‚ 123e4567-e89b-12d3-a456-...    â”‚
â”‚ poll_id          â”‚ 987f6543-e89b-12d3-a456-...    â”‚
â”‚ user_id          â”‚ 550e8400-e29b-41d4-a716-...    â”‚
â”‚ present          â”‚ NULL                            â”‚
â”‚ confirmation_status â”‚ pending_customer_response    â”‚
â”‚ attended_at      â”‚ NULL                            â”‚
â”‚ created_at       â”‚ 2025-10-22 10:00:00            â”‚
â”‚ updated_at       â”‚ 2025-10-22 10:00:00            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AFTER SCAN (API UPDATES)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               â”‚ 123e4567-e89b-12d3-a456-...    â”‚
â”‚ poll_id          â”‚ 987f6543-e89b-12d3-a456-...    â”‚
â”‚ user_id          â”‚ 550e8400-e29b-41d4-a716-...    â”‚
â”‚ present          â”‚ TRUE âœ“                          â”‚
â”‚ confirmation_status â”‚ confirmed_attended âœ“         â”‚
â”‚ attended_at      â”‚ 2025-10-22 10:30:45 âœ“          â”‚
â”‚ created_at       â”‚ 2025-10-22 10:00:00            â”‚
â”‚ updated_at       â”‚ 2025-10-22 10:30:45 âœ“          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Navigation Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DESKTOP NAVIGATION                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ADMIN DASHBOARD HEADER                                   â”‚
â”‚  [ğŸ ] [Dashboard] [ğŸ“Š] [Polls] [ğŸ’³] [Billing]            â”‚
â”‚  [ğŸ½ï¸] [Menu] [ğŸ“±] [QR Scanner] â† NEW                    â”‚
â”‚  [ğŸ“¦] [Inventory] [â•] [Create User]                      â”‚
â”‚                                                             â”‚
â”‚  ADMIN PAGES                                              â”‚
â”‚  /admin/dashboard (home)                                  â”‚
â”‚  /admin/polls (manage polls)                              â”‚
â”‚  /admin/billing (billing dashboard)                       â”‚
â”‚  /admin/menu (menu management)                            â”‚
â”‚  /admin/qr-scanner â† NEW                                  â”‚
â”‚                                                             â”‚
â”‚  USER DASHBOARD CARDS                                     â”‚
â”‚  [ğŸ’œ Bills] [ğŸ½ï¸ Menu] [ğŸ“œ History]                       â”‚
â”‚  [ğŸ”· Attendance] â† NEW  [ğŸ“Š Poll]                         â”‚
â”‚                                                             â”‚
â”‚  USER PAGES                                               â”‚
â”‚  /user/dashboard                                          â”‚
â”‚  /user/billing                                            â”‚
â”‚  /user/meal-history                                       â”‚
â”‚  /attendance â† NEW                                         â”‚
â”‚  /qr (generate QR)                                        â”‚
â”‚  /poll (respond to poll)                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOBILE NAVIGATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  BOTTOM NAVBAR (Fixed)                                    â”‚
â”‚  [ğŸ  Dashboard] [ğŸ“± QR] [ğŸ”· Attendance] â† NEW              â”‚
â”‚  [ğŸ“Š Poll] [ğŸ‘¤ Profile]                                    â”‚
â”‚                                                             â”‚
â”‚  RESPONSIVE MENUS                                         â”‚
â”‚  - Admin menu drawer slides from left                      â”‚
â”‚  - Same links as desktop header                           â”‚
â”‚  - QR Scanner included in mobile menu                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MyCanteen Application Root                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Page Layout & Navigation              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚    Admin Pages                       â”‚   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚  â”‚  â”‚ /admin/dashboard                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ DashboardHeader (UPDATED)      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â””â”€ QR Scanner button (NEW)    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ Stats cards                    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ Admin controls                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ /admin/qr-scanner (NEW)             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ Stats section                  â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ QRScanner component (NEW)      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â”œâ”€ Video stream               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â”œâ”€ Camera selector            â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â”œâ”€ Manual input               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â””â”€ Error handling             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ Recent scans table             â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚    User Pages                        â”‚   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚  â”‚  â”‚ /user/dashboard                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ ActionCards (UPDATED)           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â””â”€ Attendance card (NEW)       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ Stats cards                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ User info                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ /attendance (NEW/UPDATED)             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ Stats section                   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€ Attendance table                â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ Info box                        â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ /qr (existing)                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ QR code display                 â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚    Shared Components                 â”‚   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚  â”‚  â”‚ BottomNavbar (UPDATED)               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ Attendance link (NEW)           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ QRScanner (NEW)                      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€ Shared modal component          â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         API Integration Layer                â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ /api/attendance (NEW)                        â”‚  â”‚
â”‚  â”‚   â”œâ”€ POST - Record scan                     â”‚  â”‚
â”‚  â”‚   â””â”€ GET - Fetch records                     â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚ /api/user/profile (existing)                â”‚  â”‚
â”‚  â”‚ /api/polls/* (existing)                     â”‚  â”‚
â”‚  â”‚ /api/billing/* (existing)                   â”‚  â”‚
â”‚  â”‚ /api/menu/* (existing)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API Request/Response Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ATTENDANCE SCANNING FLOW                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  ADMIN SCANS QR CODE                               â”‚
â”‚         â†“                                           â”‚
â”‚  QRScanner component receives data                 â”‚
â”‚         â†“                                           â”‚
â”‚  Validates QR format (JSON)                        â”‚
â”‚         â†“                                           â”‚
â”‚  onScan callback triggered                         â”‚
â”‚         â†“                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  POST /api/attendance                        â”‚   â”‚
â”‚  â”‚                                              â”‚   â”‚
â”‚  â”‚  Request:                                    â”‚   â”‚
â”‚  â”‚  {                                           â”‚   â”‚
â”‚  â”‚    "scannedData": {                         â”‚   â”‚
â”‚  â”‚      "userId": "550e8400...",               â”‚   â”‚
â”‚  â”‚      "type": "attendance",                  â”‚   â”‚
â”‚  â”‚      ...                                     â”‚   â”‚
â”‚  â”‚    }                                         â”‚   â”‚
â”‚  â”‚  }                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â†“                                           â”‚
â”‚  API PROCESSING                                    â”‚
â”‚  1. Check authentication âœ“                         â”‚
â”‚  2. Check if admin âœ“                               â”‚
â”‚  3. Validate QR data âœ“                            â”‚
â”‚  4. Fetch user from DB âœ“                           â”‚
â”‚  5. Get today's poll âœ“                             â”‚
â”‚  6. Create/update poll_responses âœ“                 â”‚
â”‚         â†“                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Response (200 OK)                       â”‚   â”‚
â”‚  â”‚                                              â”‚   â”‚
â”‚  â”‚  Response:                                   â”‚   â”‚
â”‚  â”‚  {                                           â”‚   â”‚
â”‚  â”‚    "success": true,                         â”‚   â”‚
â”‚  â”‚    "message": "Attendance recorded...",    â”‚   â”‚
â”‚  â”‚    "data": {                                â”‚   â”‚
â”‚  â”‚      "attendanceId": "uuid",               â”‚   â”‚
â”‚  â”‚      "userName": "John Doe",               â”‚   â”‚
â”‚  â”‚      "status": "confirmed_attended",       â”‚   â”‚
â”‚  â”‚      "attendedAt": "2025-10-22T..."        â”‚   â”‚
â”‚  â”‚    }                                         â”‚   â”‚
â”‚  â”‚  }                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â†“                                           â”‚
â”‚  handleScan callback processes response            â”‚
â”‚         â†“                                           â”‚
â”‚  Show success notification                         â”‚
â”‚         â†“                                           â”‚
â”‚  fetchAttendanceData() refreshes data             â”‚
â”‚         â†“                                           â”‚
â”‚  Update stats + recent scans table                â”‚
â”‚         â†“                                           â”‚
â”‚  Auto-close scanner after 2 seconds              â”‚
â”‚         â†“                                           â”‚
â”‚  DONE âœ“                                            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ERROR HANDLING SCENARIOS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                â”‚
â”‚  CAMERA ERRORS                                â”‚
â”‚  â”œâ”€ NotAllowedError                           â”‚
â”‚  â”‚  â†’ "Camera access denied..."               â”‚
â”‚  â”œâ”€ NotFoundError                             â”‚
â”‚  â”‚  â†’ "No camera device found"                â”‚
â”‚  â””â”€ Other                                     â”‚
â”‚     â†’ "Failed to access camera: {error}"      â”‚
â”‚                                                â”‚
â”‚  QR DATA ERRORS                               â”‚
â”‚  â”œâ”€ Invalid JSON                              â”‚
â”‚  â”‚  â†’ "Invalid QR code format"                â”‚
â”‚  â”œâ”€ Missing userId                            â”‚
â”‚  â”‚  â†’ "Invalid QR: missing userId"            â”‚
â”‚  â””â”€ Wrong type                                â”‚
â”‚     â†’ "Invalid QR: type not attendance"       â”‚
â”‚                                                â”‚
â”‚  API ERRORS                                   â”‚
â”‚  â”œâ”€ 401 Unauthorized                          â”‚
â”‚  â”‚  â†’ "Not logged in - redirect to /login"    â”‚
â”‚  â”œâ”€ 403 Forbidden                             â”‚
â”‚  â”‚  â†’ "Only admins can access"                â”‚
â”‚  â”œâ”€ 404 Not Found                             â”‚
â”‚  â”‚  â†’ "User not found" or "No poll today"     â”‚
â”‚  â”œâ”€ 400 Bad Request                           â”‚
â”‚  â”‚  â†’ "Invalid QR data"                       â”‚
â”‚  â””â”€ 500 Server Error                          â”‚
â”‚     â†’ "Internal server error"                 â”‚
â”‚                                                â”‚
â”‚  RECOVERY ACTIONS                             â”‚
â”‚  â”œâ”€ Show error notification                   â”‚
â”‚  â”œâ”€ Keep scanner open (if camera error)       â”‚
â”‚  â”œâ”€ Log error to console                      â”‚
â”‚  â”œâ”€ Suggest user action                       â”‚
â”‚  â””â”€ Allow retry                               â”‚
â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram (Complete)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPLETE DATA FLOW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  USER GENERATES QR (/qr)                                 â”‚
â”‚  â”œâ”€ Profile fetch: auth.users + profiles_new             â”‚
â”‚  â”œâ”€ Create JSON payload                                   â”‚
â”‚  â”œâ”€ Generate QR code image                               â”‚
â”‚  â””â”€ Display on page                                       â”‚
â”‚        â”‚                                                   â”‚
â”‚        â”‚ QR CODE CREATED                                  â”‚
â”‚        â”‚ "550e8400..., John, john@email, CSE, 2025..."   â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  ADMIN SCANS QR (/admin/qr-scanner)                       â”‚
â”‚  â”œâ”€ Open QRScanner modal                                  â”‚
â”‚  â”œâ”€ Request camera permission                            â”‚
â”‚  â”œâ”€ Stream video from camera                             â”‚
â”‚  â”œâ”€ Detect QR code                                        â”‚
â”‚  â””â”€ Extract JSON data                                     â”‚
â”‚        â”‚                                                   â”‚
â”‚        â”‚ QR SCANNED                                       â”‚
â”‚        â”‚ Data: userId, type, timestamp, etc.             â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  API RECORDS ATTENDANCE (/api/attendance - POST)          â”‚
â”‚  â”œâ”€ Validate authentication                              â”‚
â”‚  â”œâ”€ Check admin role                                      â”‚
â”‚  â”œâ”€ Validate QR data                                      â”‚
â”‚  â”œâ”€ Fetch user: profiles_new                            â”‚
â”‚  â”œâ”€ Get today's poll: polls table                         â”‚
â”‚  â”œâ”€ Create/update: poll_responses                        â”‚
â”‚  â”‚  â”œâ”€ poll_id: from today's poll                        â”‚
â”‚  â”‚  â”œâ”€ user_id: from QR data                             â”‚
â”‚  â”‚  â”œâ”€ confirmation_status: 'confirmed_attended'         â”‚
â”‚  â”‚  â”œâ”€ attended_at: NOW()                                â”‚
â”‚  â”‚  â””â”€ SAVE to database                                   â”‚
â”‚  â””â”€ Return success response                              â”‚
â”‚        â”‚                                                   â”‚
â”‚        â”‚ ATTENDANCE RECORDED                              â”‚
â”‚        â”‚ poll_responses table updated                    â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  STATS UPDATE                                             â”‚
â”‚  â”œâ”€ Query: poll_responses WHERE poll_id = today()        â”‚
â”‚  â”œâ”€ Count: confirmation_status = 'confirmed_attended'    â”‚
â”‚  â””â”€ Update UI stats cards                                 â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  RECENT SCANS TABLE UPDATE                               â”‚
â”‚  â”œâ”€ Query: recent poll_responses with user data          â”‚
â”‚  â”œâ”€ Fetch: profiles_new join for user info              â”‚
â”‚  â”œâ”€ Display: name, email, dept, status, time            â”‚
â”‚  â””â”€ Sort: by created_at DESC                            â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  USER CHECKS HISTORY (/attendance)                       â”‚
â”‚  â”œâ”€ Query: poll_responses WHERE user_id = current_user   â”‚
â”‚  â”œâ”€ Fetch: polls table for poll info                     â”‚
â”‚  â”œâ”€ Calculate: Present count, Absent count, Rate %       â”‚
â”‚  â”œâ”€ Display: attendance table with all records           â”‚
â”‚  â””â”€ Color code: Present (green), Absent (red), etc.      â”‚
â”‚        â”‚                                                   â”‚
â”‚        â–¼                                                   â”‚
â”‚  ATTENDANCE VISIBLE                                       â”‚
â”‚  â”œâ”€ User sees record in /attendance                      â”‚
â”‚  â”œâ”€ Status: âœ“ Present                                     â”‚
â”‚  â”œâ”€ Time: 10:30:45 AM                                     â”‚
â”‚  â””â”€ Confirmed_attended = 'confirmed_attended'            â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Status:** âœ… Complete Architecture Documented  
**Last Updated:** October 22, 2025  
**Version:** 1.0.0
